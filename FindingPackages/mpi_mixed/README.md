The code contains preprocessor statements (#ifdef HAVE_MPI ... #else ... #endif) so that
we can compile either a sequential or a parallel executable with the same source code